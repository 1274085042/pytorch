====================================================================================================================================== short test summary info ======================================================================================================================================
FAILED [0.0967s] test_ops_fwd_gradients.py::TestFwdGradientsCPU::test_forward_mode_AD_dot_cpu_complex128 - Exception: Caused by sample input at index 0: SampleInput(input=Tensor[size=(5,), device="cpu", dtype=torch.complex128], args=TensorList[Tensor[size=(5,), device="cpu", dtype=torch.com...
SKIPPED [0.0007s] [15] test_ops_fwd_gradients.py:28: Skipped!
SKIPPED [0.0007s] [175] test_ops_fwd_gradients.py:28: Skipped! Op doesn't support autograd for this dtype.
SKIPPED [0.0007s] [2] test_ops_fwd_gradients.py:28: Numerous errors
SKIPPED [0.0007s] [2] test_ops_fwd_gradients.py:28: Passes on complex128 and float64 only
SKIPPED [0.0007s] [105] test_ops_fwd_gradients.py:28: PyTorch compiled without Lapack
SKIPPED [0.0007s] [2] test_ops_fwd_gradients.py:28: Barely fails
SKIPPED [0.0007s] [10] test_ops_fwd_gradients.py:28: Only runs on cuda
SKIPPED [0.0007s] [1] test_ops_fwd_gradients.py:28: Skipped! Flaky
SKIPPED [0.0007s] [1] test_ops_fwd_gradients.py:28: Gradients are incorrect!
SKIPPED [0.0007s] [7] test_ops_fwd_gradients.py:28: Skipping - testing takes an unreasonably long time, #79528
SKIPPED [0.0007s] [23] test_ops_fwd_gradients.py:58: Skipped!
SKIPPED [0.0007s] [175] test_ops_fwd_gradients.py:58: Skipped! Op doesn't support autograd for this dtype.
SKIPPED [0.0007s] [2] test_ops_fwd_gradients.py:58: Numerous errors
SKIPPED [0.0007s] [106] test_ops_fwd_gradients.py:58: PyTorch compiled without Lapack
SKIPPED [0.0007s] [10] test_ops_fwd_gradients.py:58: Only runs on cuda
SKIPPED [0.0007s] [1] test_ops_fwd_gradients.py:58: Gradients are incorrect!
SKIPPED [0.0007s] [7] test_ops_fwd_gradients.py:58: Skipping - testing takes an unreasonably long time, #79528
SKIPPED [0.0007s] [531] test_ops_fwd_gradients.py:66: Skipped! Operation does not support inplace autograd.
SKIPPED [0.0007s] [12] test_ops_fwd_gradients.py:66: Skipped!
SKIPPED [0.0007s] [1] test_ops_fwd_gradients.py:66: In-place abs not supported for complex tensors
SKIPPED [0.0007s] [175] test_ops_fwd_gradients.py:66: Skipped! Op doesn't support autograd for this dtype.
SKIPPED [0.0007s] [2] test_ops_fwd_gradients.py:66: Numerous errors
SKIPPED [0.0007s] [106] test_ops_fwd_gradients.py:66: PyTorch compiled without Lapack
SKIPPED [0.0007s] [10] test_ops_fwd_gradients.py:66: Only runs on cuda
SKIPPED [0.0007s] [1] test_ops_fwd_gradients.py:66: Gradients are incorrect!
SKIPPED [0.0007s] [2] test_ops_fwd_gradients.py:66: PyTorch is built without MKL support
SKIPPED [0.0007s] [7] test_ops_fwd_gradients.py:66: Skipping - testing takes an unreasonably long time, #79528
XFAIL [0.2211s] test_ops_fwd_gradients.py::TestFwdGradientsCPU::test_fn_fwgrad_bwgrad_as_strided_partial_views_cpu_complex128 - reason:
XFAIL [0.0778s] test_ops_fwd_gradients.py::TestFwdGradientsCPU::test_fn_fwgrad_bwgrad_bfloat16_cpu_complex128 - reason:
XFAIL [0.0551s] test_ops_fwd_gradients.py::TestFwdGradientsCPU::test_fn_fwgrad_bwgrad_bfloat16_cpu_float64 - reason:
XFAIL [0.0814s] test_ops_fwd_gradients.py::TestFwdGradientsCPU::test_fn_fwgrad_bwgrad_cfloat_cpu_complex128 - reason:
XFAIL [0.0652s] test_ops_fwd_gradients.py::TestFwdGradientsCPU::test_fn_fwgrad_bwgrad_cfloat_cpu_float64 - reason:
XFAIL [0.0799s] test_ops_fwd_gradients.py::TestFwdGradientsCPU::test_fn_fwgrad_bwgrad_chalf_cpu_complex128 - reason:
XFAIL [0.0650s] test_ops_fwd_gradients.py::TestFwdGradientsCPU::test_fn_fwgrad_bwgrad_chalf_cpu_float64 - reason:
XFAIL [0.0787s] test_ops_fwd_gradients.py::TestFwdGradientsCPU::test_fn_fwgrad_bwgrad_float_cpu_complex128 - reason:
XFAIL [0.0557s] test_ops_fwd_gradients.py::TestFwdGradientsCPU::test_fn_fwgrad_bwgrad_float_cpu_float64 - reason:
XFAIL [0.0759s] test_ops_fwd_gradients.py::TestFwdGradientsCPU::test_fn_fwgrad_bwgrad_half_cpu_complex128 - reason:
XFAIL [0.0561s] test_ops_fwd_gradients.py::TestFwdGradientsCPU::test_fn_fwgrad_bwgrad_half_cpu_float64 - reason:
XFAIL [0.8419s] test_ops_fwd_gradients.py::TestFwdGradientsCPU::test_fn_fwgrad_bwgrad_logcumsumexp_cpu_complex128 - reason:
XFAIL [0.5463s] test_ops_fwd_gradients.py::TestFwdGradientsCPU::test_fn_fwgrad_bwgrad_polar_cpu_float64 - reason:
XFAIL [0.3358s] test_ops_fwd_gradients.py::TestFwdGradientsCPU::test_fn_fwgrad_bwgrad_scatter_reduce_prod_cpu_float64 - reason:
XFAIL [0.0999s] test_ops_fwd_gradients.py::TestFwdGradientsCPU::test_forward_mode_AD_as_strided_partial_views_cpu_complex128 - reason:
XFAIL [0.0546s] test_ops_fwd_gradients.py::TestFwdGradientsCPU::test_forward_mode_AD_as_strided_partial_views_cpu_float64 - reason:
XFAIL [0.0974s] test_ops_fwd_gradients.py::TestFwdGradientsCPU::test_forward_mode_AD_as_strided_scatter_cpu_complex128 - reason:
XFAIL [0.0552s] test_ops_fwd_gradients.py::TestFwdGradientsCPU::test_forward_mode_AD_as_strided_scatter_cpu_float64 - reason:
XFAIL [0.1087s] test_ops_fwd_gradients.py::TestFwdGradientsCPU::test_forward_mode_AD_bernoulli_cpu_float64 - reason:
XFAIL [0.0759s] test_ops_fwd_gradients.py::TestFwdGradientsCPU::test_forward_mode_AD_bfloat16_cpu_complex128 - reason: 
XFAIL [0.0534s] test_ops_fwd_gradients.py::TestFwdGradientsCPU::test_forward_mode_AD_bfloat16_cpu_float64 - reason:
XFAIL [0.0739s] test_ops_fwd_gradients.py::TestFwdGradientsCPU::test_forward_mode_AD_cfloat_cpu_complex128 - reason:
XFAIL [0.0550s] test_ops_fwd_gradients.py::TestFwdGradientsCPU::test_forward_mode_AD_cfloat_cpu_float64 - reason:
XFAIL [0.0723s] test_ops_fwd_gradients.py::TestFwdGradientsCPU::test_forward_mode_AD_chalf_cpu_complex128 - reason:
XFAIL [0.0498s] test_ops_fwd_gradients.py::TestFwdGradientsCPU::test_forward_mode_AD_chalf_cpu_float64 - reason:
XFAIL [0.0988s] test_ops_fwd_gradients.py::TestFwdGradientsCPU::test_forward_mode_AD_cov_cpu_complex128 - reason:
XFAIL [0.0880s] test_ops_fwd_gradients.py::TestFwdGradientsCPU::test_forward_mode_AD_cov_cpu_float64 - reason:
XFAIL [0.0760s] test_ops_fwd_gradients.py::TestFwdGradientsCPU::test_forward_mode_AD_float_cpu_complex128 - reason:
XFAIL [0.0538s] test_ops_fwd_gradients.py::TestFwdGradientsCPU::test_forward_mode_AD_float_cpu_float64 - reason:
XFAIL [0.0742s] test_ops_fwd_gradients.py::TestFwdGradientsCPU::test_forward_mode_AD_half_cpu_complex128 - reason:
XFAIL [0.0533s] test_ops_fwd_gradients.py::TestFwdGradientsCPU::test_forward_mode_AD_half_cpu_float64 - reason:
XFAIL [0.3562s] test_ops_fwd_gradients.py::TestFwdGradientsCPU::test_forward_mode_AD_logcumsumexp_cpu_complex128 - reason:
XFAIL [0.1046s] test_ops_fwd_gradients.py::TestFwdGradientsCPU::test_forward_mode_AD_nn_functional_feature_alpha_dropout_with_train_cpu_float64 - reason:
XFAIL [0.1018s] test_ops_fwd_gradients.py::TestFwdGradientsCPU::test_forward_mode_AD_scatter_reduce_prod_cpu_float64 - reason:
XFAIL [0.1096s] test_ops_fwd_gradients.py::TestFwdGradientsCPU::test_inplace_forward_mode_AD_as_strided_partial_views_cpu_complex128 - reason:
XFAIL [0.0536s] test_ops_fwd_gradients.py::TestFwdGradientsCPU::test_inplace_forward_mode_AD_as_strided_partial_views_cpu_float64 - reason:
XFAIL [0.1043s] test_ops_fwd_gradients.py::TestFwdGradientsCPU::test_inplace_forward_mode_AD_nn_functional_feature_alpha_dropout_with_train_cpu_float64 - reason:
XFAIL [0.0769s] test_ops_fwd_gradients.py::TestFwdGradientsCPU::test_inplace_forward_mode_AD_nn_functional_rrelu_cpu_float64 - reason:
XFAIL [0.0766s] test_ops_fwd_gradients.py::TestFwdGradientsCPU::test_inplace_forward_mode_AD_scatter_reduce_prod_cpu_float64 - reason:
======================================================================================================== 1 failed, 1542 passed, 1491 skipped, 2 deselected, 39 xfailed in 948.99s (0:15:48) ========================================================================================================= 

============================================================================================================================================= FAILURES ============================================================================================================================================== 
____________________________________________________________________________________________________________________ TestFwdGradientsCPU.test_forward_mode_AD_dot_cpu_complex128 ____________________________________________________________________________________________________________________ 
Traceback (most recent call last):
  File "C:\Users\iremyuksel\AppData\Local\Programs\Python\Python311-arm64\Lib\site-packages\torch\testing\_internal\common_device_type.py", line 918, in test_wrapper
    return test(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "test_ops_fwd_gradients.py", line 64, in test_forward_mode_AD
    self._forward_grad_helper(device, dtype, op, op.get_op(), is_inplace=False)
  File "test_ops_fwd_gradients.py", line 50, in _forward_grad_helper
    call_grad_test_helper()
  File "test_ops_fwd_gradients.py", line 47, in call_grad_test_helper
    self._grad_test_helper(device, dtype, op, variant, check_forward_ad=True, check_backward_ad=False,
  File "C:\Users\iremyuksel\AppData\Local\Programs\Python\Python311-arm64\Lib\site-packages\torch\testing\_internal\common_utils.py", line 4860, in _grad_test_helper
    return self._check_helper(device, dtype, op, variant, 'gradcheck', check_forward_ad=check_forward_ad,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\iremyuksel\AppData\Local\Programs\Python\Python311-arm64\Lib\site-packages\torch\testing\_internal\common_utils.py", line 4829, in _check_helper
    self.assertTrue(gradcheck(fn, gradcheck_args,
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\iremyuksel\AppData\Local\Programs\Python\Python311-arm64\Lib\site-packages\torch\testing\_internal\common_utils.py", line 4381, in gradcheck
    return torch.autograd.gradcheck(fn, inputs, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\iremyuksel\AppData\Local\Programs\Python\Python311-arm64\Lib\site-packages\torch\autograd\gradcheck.py", line 2051, in gradcheck
    return _gradcheck_helper(**args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\iremyuksel\AppData\Local\Programs\Python\Python311-arm64\Lib\site-packages\torch\autograd\gradcheck.py", line 2097, in _gradcheck_helper
    _test_batched_grad_forward_ad(func, tupled_inputs)
  File "C:\Users\iremyuksel\AppData\Local\Programs\Python\Python311-arm64\Lib\site-packages\torch\autograd\gradcheck.py", line 1108, in _test_batched_grad_forward_ad
    raise GradcheckError(
torch.autograd.gradcheck.GradcheckError: For output 0 and input 0:


gradcheck failed while testing batched gradient computation with forward-mode AD.
This test is enabled automatically when both `check_batched_grad=True`
and `check_forward_ad=True`, but can be disabled in the following ways
dependong on how the test was invoked (via a test that calls gradcheck
directly or via an autogenerated test).

If you are adding a new operator, please file an issue and then use one of the
workarounds. The workaround depends on how your test invokes gradcheck/gradgradcheck.
If the test
- manually invokes gradcheck/gradgradcheck, then call gradcheck/gradgradcheck
  with `check_batched_forward_grad=False` as a keyword argument.
- is OpInfo-based (e.g., in test_ops_gradients.py), then modify the OpInfo for the test
  to have `check_batched_forward_grad=False`


Got:
tensor([21.4559-3.1655j, -1.6187+13.8622j], dtype=torch.complex128)

Expected:
tensor([0.+0.j, 0.+0.j], dtype=torch.complex128)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\iremyuksel\AppData\Local\Programs\Python\Python311-arm64\Lib\unittest\case.py", line 57, in testPartExecutor
    yield
  File "C:\Users\iremyuksel\AppData\Local\Programs\Python\Python311-arm64\Lib\unittest\case.py", line 623, in run
    self._callTestMethod(testMethod)
  File "C:\Users\iremyuksel\AppData\Local\Programs\Python\Python311-arm64\Lib\unittest\case.py", line 579, in _callTestMethod
    if method() is not None:
       ^^^^^^^^
  File "C:\Users\iremyuksel\AppData\Local\Programs\Python\Python311-arm64\Lib\site-packages\torch\testing\_internal\common_utils.py", line 2683, in wrapper
    method(*args, **kwargs)
  File "C:\Users\iremyuksel\AppData\Local\Programs\Python\Python311-arm64\Lib\site-packages\torch\testing\_internal\common_device_type.py", line 416, in instantiated_test
    result = test(self, **param_kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\iremyuksel\AppData\Local\Programs\Python\Python311-arm64\Lib\site-packages\torch\testing\_internal\common_utils.py", line 1360, in wrapper
    fn(*args, **kwargs)
  File "C:\Users\iremyuksel\AppData\Local\Programs\Python\Python311-arm64\Lib\site-packages\torch\testing\_internal\common_device_type.py", line 924, in test_wrapper
    raise Exception(
Exception: Caused by sample input at index 0: SampleInput(input=Tensor[size=(5,), device="cpu", dtype=torch.complex128], args=TensorList[Tensor[size=(5,), device="cpu", dtype=torch.complex128]], kwargs={}, broadcasts_input=False, name='')

To execute this test, run the following from the base repo dir:
     python test_ops_fwd_gradients.py -k test_forward_mode_AD_dot_cpu_complex128

This message can be suppressed by setting PYTORCH_PRINT_REPRO_ON_FAILURE=0